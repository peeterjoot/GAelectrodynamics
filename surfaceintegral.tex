%
% Copyright © 2018 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%{
%%%\input{../latex/blogpost.tex}
%%%\renewcommand{\basename}{surfaceintegral}
%%%%\renewcommand{\dirname}{notes/phy1520/}
%%%\renewcommand{\dirname}{notes/ece1228-electromagnetic-theory/}
%%%%\newcommand{\dateintitle}{}
%%%%\newcommand{\keywords}{}
%%%
%%%\input{../latex/peeter_prologue_print2.tex}
%%%
%%%\usepackage{peeters_layout_exercise}
%%%\usepackage{peeters_braket}
%%%\usepackage{peeters_figures}
%%%\usepackage{siunitx}
%%%%\usepackage{mhchem} % \ce{}
%%%%\usepackage{macros_bm} % \bcM
%%%%\usepackage{macros_qed} % \qedmarker
%%%\usepackage{txfonts} % \ointclockwise
%%%
%%%\beginArtNoToc
%%%
%%%\generatetitle{Multivector surface integral.}
%\section{Surface integral.}
%\label{chap:surfaceintegral}

%%As mentioned in a line integral context,
%%multivectors may not commute with the vector derivative or the differential, so we allow the vector derivative to act bidirectionally using the chain rule.
%%The scope of the action of the vector derivative when acting only to the left or right is indicated using braces above.
%%Should we wish to only integrate single functions, we can set either of the other to \( 1 \), yielding integrals of the form
%%\( \int_S F d^2\Bx \lboldpartial, \) or \( \int_S d^2\Bx \boldpartial G \).

The surface integral specialization of \cref{thm:fundamentalTheoremOfCalculus:1} is

\input{Theorem_multivector_surface_integral.tex}
To prove \cref{thm:surfaceintegral:100} we start by expanding the multivector product \( d^2\Bx\, \boldpartial \) in curvilinear coordinates, where we discover
that this product has only a vector grade.
The vector derivative, the projection of the gradient onto the surface at the point of integration (also called the tangent space), now has two components
\begin{dmath}\label{eqn:surfaceintegral:200}
\boldpartial
=
\sum_i \Bx^i (\Bx_i \cdot \spacegrad)
=
\Bx^u \PD{u}{}
+
\Bx^v \PD{v}{}
\equiv
\Bx^u \partial_u
+
\Bx^v \partial_v.
\end{dmath}
To see why the product of the area elements and the vector derivative
\begin{dmath}\label{eqn:surfaceintegral:300}
d^2\Bx\, \boldpartial
=
du dv\, \lr{ \Bx_u \wedge \Bx_v } \lr{ \Bx^u \partial_u + \Bx^v \partial_v },
\end{dmath}
has only a vector grade, observe that \( \Bx^u \in \Span \setlr{ \Bx_u, \Bx_v } \), so
\begin{dmath}\label{eqn:surfaceintegral:320}
\lr{ \Bx_u \wedge \Bx_v } \Bx^u
=
\lr{ \Bx_u \wedge \Bx_v } \cdot \Bx^u
+
\cancel{ \lr{ \Bx_u \wedge \Bx_v } \wedge \Bx^u }
=
\lr{ \Bx_u \wedge \Bx_v } \cdot \Bx^u
=
\Bx_u \lr{ \Bx_v \cdot \Bx^u } -
\Bx_v \lr{ \Bx_u \cdot \Bx^u }
=
-\Bx_v.
\end{dmath}
Similarly
\begin{dmath}\label{eqn:surfaceintegral:340}
\lr{ \Bx_u \wedge \Bx_v } \Bx^v
=
\lr{ \Bx_u \wedge \Bx_v } \cdot \Bx^v
+
\cancel{ \lr{ \Bx_u \wedge \Bx_v } \wedge \Bx^v }
=
\lr{ \Bx_u \wedge \Bx_v } \cdot \Bx^v
=
\Bx_u \lr{ \Bx_v \cdot \Bx^v } -
\Bx_v \lr{ \Bx_u \cdot \Bx^v }
=
\Bx_u.
\end{dmath}
Not only does \cref{eqn:surfaceintegral:300} have only a vector grade, that product reduces to just
\begin{dmath}\label{eqn:surfaceintegral:360}
d^2\Bx\, \boldpartial
=
\Bx_u \partial_v
-\Bx_v \partial_u.
\end{dmath}
Inserting \cref{eqn:surfaceintegral:360} into the surface integral, we find
\begin{dmath}\label{eqn:surfaceintegral:380}
\int_S F d^2\Bx\, \boldpartial G
=
\int_S \lr{ F d^2\Bx\, \lboldpartial} G
+
\int_S F d^2\Bx \lr{ \rboldpartial G }
=
\int_S du dv\, \lr{ \partial_v F \Bx_u - \partial_u F \Bx_v } G
+
\int_S du dv\, F \lr{ \Bx_u \partial_v G - \Bx_v \partial_u G }
=
\int_S du dv\, \lr{ \PD{v}{F} \PD{u}{\Bx} - \PD{u}{F} \PD{v}{\Bx} } G
+
\int_S du dv\, F \lr{ \PD{u}{\Bx} \PD{v}{G} - \PD{v}{\Bx} \PD{u}{G} }
=
\int_S du dv\, \PD{v}{} \lr{ F \PD{u}{\Bx} G } - \int_S du dv\, \PD{u}{} \lr{ F \PD{v}{\Bx} G }
-
\int_S du dv\, F \lr{ \PD{v}{} \PD{u}{\Bx} - \PD{u}{} \PD{v}{\Bx} } G
=
\int_S du dv\, \PD{v}{} \lr{ F \PD{u}{\Bx} G } - \int_S du dv\, \PD{u}{} \lr{ F \PD{v}{\Bx} G }.
\end{dmath}
This leaves two perfect differentials, which can both be integrated separately
\begin{dmath}\label{eqn:surfaceintegral:400}
\int_S F d^2\Bx\, \boldpartial G
=
\int_{\Delta u} du\, \evalbar{\lr{ F \PD{u}{\Bx} G }}{\Delta v} - \int_{\Delta v} dv\, \evalbar{\lr{ F \PD{v}{\Bx} G }}{\Delta u}
=
\int_{\Delta u} \evalbar{\lr{ F d\Bx_u G }}{\Delta v} - \int_{\Delta v} \evalbar{\lr{ F d\Bx_v G }}{\Delta u}.
\end{dmath}
\Cref{eqn:surfaceintegral:400} is an explicit algebraic expression of the boundary integral of \cref{thm:surfaceintegral:100}.
To complete the proof, we are left with the task of geometrically interpretting this integrand.
Suppose we are integrating over the unit parameter volume space \( [u, v] \in [0,1] \otimes [0,1] \) as illustrated in
\cref{fig:twoParameterDifferentialBoundary:twoParameterDifferentialBoundaryFig2}.
\imageFigure
%\imageTwoFigures
{../figures/GAelectrodynamics/twoParameterDifferentialBoundaryFig2}
%{../figures/GAelectrodynamics/twoParameterDifferentialBoundaryEditedFig3}
%{Contour for two parameter surface boundary, and subdivision into finer loop mesh.}
{Contour for two parameter surface boundary.}
%{Contour for two parameter surface boundary, and subdivision into finer loop mesh.}
{fig:twoParameterDifferentialBoundary:twoParameterDifferentialBoundaryFig2}
{0.4}
%{scale=0.4}
Comparing to the figure we see that we've ended up with a clockwise line integral around the boundary of the surface.
For a given subset of the surface, the bivector area element can be chosen small enough that it lies in the tangent space
to the surface at the point of integration.
In that case, a larger bounding loop can be conceptualized as the sum of a number of smaller ones, as sketched
in \cref{fig:loopIntegralInfinitesimalSum:loopIntegralInfinitesimalSumFig2},
in which case the
contributions of the interior loop paths (red and blue) cancel out, leaving only the exterior loop contributions (green.)  When that subdivision is made small enough (assuming that the surface is continuous and differentiable along each of the parameterization paths) then each area element approximates the tangent space at the point of evaluation.

%\imageFigure{../figures/gabook/loopIntegralInfinitesimalSumFig2}{Sum of infinitesimal loops.}{fig:loopIntegralInfinitesimalSum:loopIntegralInfinitesimalSumFig2}{0.35}
\imageFigure{../figures/GAelectrodynamics/twoParameterDifferentialBoundaryEditedFig3}{Sum of infinitesimal loops.}{fig:loopIntegralInfinitesimalSum:loopIntegralInfinitesimalSumFig2}{0.35}

\subsubsection{Two parameter Stokes' theorem.}

Two 
special cases of \cref{thm:surfaceintegral:100}, both variations of Stokes' theorem, result by considering scalar and vector functions.  For the scalar case we have
\input{Theorem_surface_integral_of_scalar_stokes.tex}

To show the first part, we can split the (multivector) surface integral into vector and trivector grades
\begin{dmath}\label{eqn:surfaceintegral:440}
\int_S d^2\Bx\, \boldpartial f
=
\int_S d^2\Bx \cdot \boldpartial f
+
\int_S d^2\Bx \wedge \boldpartial f.
\end{dmath}

Since \( \Bx^u, \Bx^v \) both lie in the span of \( \setlr{ \Bx_u, \Bx_v } \),
\( d^2\Bx \wedge \boldpartial = 0 \), killing the second integral in \cref{eqn:surfaceintegral:440}.
If the gradient is decomposed into its projection along the tangent
space (the vector derivative) and its perpendicular components, only the vector derivative components of the
gradient contribute to its dot product with the area element.  That is
\begin{dmath}\label{eqn:surfaceintegral:460}
d^2 \Bx \cdot \spacegrad
=
d^2 \Bx \cdot \lr{ \Bx^u \partial_u + \Bx^v \partial_v + \cdots }
=
d^2 \Bx \cdot \lr{ \Bx^u \partial_u + \Bx^v \partial_v }
=
d^2 \Bx \cdot \boldpartial.
\end{dmath}

This means that for a scalar function
\begin{dmath}\label{eqn:surfaceintegral:480}
\int_S d^2\Bx\, \boldpartial f
=
\int_S d^2\Bx \cdot \spacegrad f.
\end{dmath}

The second part of the theorem follows by grade selection, and application of a duality transformation for the area element
\begin{dmath}\label{eqn:surfaceintegral:500}
d^2 \Bx \cdot \spacegrad f
=
\gpgradeone{ d^2 \Bx \spacegrad f }
=
dA\, \gpgradeone{ I \ncap \spacegrad f }
=
dA\, \gpgradeone{ I \lr{ \ncap \cdot \spacegrad f + I \ncap \cross \spacegrad f} }
=
-dA\, \ncap \cross \spacegrad f.
\end{dmath}

back substitution of \cref{eqn:surfaceintegral:500} completes the proof of \cref{thm:surfaceintegral:420}.

For vector functions we have

\input{Theorem_surface_integral_of_vector_stokes.tex}

%%This follows by setting \( F = 1, G = \Bf \) in \cref{thm:surfaceintegral:100} and selecting the scalar grade.  In particular we may form the
%%scalar selection of \( d^2 \Bx \boldpartial \Bf \) in two different ways.  The first is
%%\begin{dmath}\label{eqn:surfaceintegral:520}
%%\gpgradezero{ d^2 \Bx \boldpartial \Bf }
%%=
%%\gpgradezero{ (d^2 \Bx \cdot \boldpartial + d^2 \Bx \wedge \boldpartial ) \Bf }.
%%\end{dmath}
%%
%%The \( d^2 \Bx \wedge \boldpartial \) product with \( \Bf \) has only bivector and quad-vector components (the latter is zero in \R{3}), so its scalar grade selection is zero, and we are left with
%%\begin{dmath}\label{eqn:surfaceintegral:540}
%%\gpgradezero{ d^2 \Bx \boldpartial \Bf }
%%=
%%(d^2 \Bx \cdot \boldpartial) \cdot \Bf
%%=
%%(d^2 \Bx \cdot \spacegrad) \cdot \Bf,
%%\end{dmath}
%%where we have used \cref{eqn:surfaceintegral:460} again.  This product can also be written as
%%\begin{dmath}\label{eqn:surfaceintegral:560}
%%(d^2 \Bx \cdot \spacegrad) \cdot \Bf
%%=
%%\gpgradezero{ (d^2 \Bx \cdot \spacegrad) \Bf }
%%=
%%\gpgradezero{ (d^2 \Bx \spacegrad - d^2 \Bx \wedge \spacegrad) \Bf }
%%=
%%\gpgradezero{ d^2 \Bx \spacegrad \Bf }
%%=
%%\gpgradezero{ d^2 \Bx \lr{ \cancel{ \spacegrad \cdot \Bf } + \spacegrad \wedge \Bf } }
%%=
%%d^2 \Bx \cdot \lr{ \spacegrad \wedge \Bf }.
%%\end{dmath}
%%
%%\begin{dmath}\label{eqn:surfaceintegral:580}
%%\ointclockwise_{\partial S} d\Bx \cdot \Bf
%%=
%%\gpgradezero{ \int_S d^2\Bx \boldpartial \Bf }
%%=
%%\int_S \lr{ d^2\Bx \cdot \spacegrad } \cdot \Bf
%%=
%%\int_S d^2\Bx \cdot \lr{ \spacegrad \wedge \Bf },
%%\end{dmath}
%%as claimed.  In particular in \R{3}, we have
%%\begin{dmath}\label{eqn:surfaceintegral:600}
%%d^2\Bx \cdot \lr{ \spacegrad \wedge \Bf }
%%=
%%dA \gpgradezero{ I \ncap I \lr{ \spacegrad \cross \Bf } }
%%=
%%-dA \ncap \cdot \lr{ \spacegrad \cross \Bf }.
%%\end{dmath}
%%
%%Substitution into \cref{eqn:surfaceintegral:580} proves the last part of \cref{thm:surfaceintegral:500}.
%%
\subsubsection{Green's theorem.}

\Cref{thm:surfaceintegral:500}, when stated in terms of coordinates, is another well known result.
\input{Theorem_greens.tex}

\todo{Add an example (lots to pick from in any 3rd term calc text).}

The first equality in \cref{thm:surfaceintegral:620} holds in \R{N} for vectors expressed in terms of an arbitrary curvilinear basis.
Only the (curvilinear) coordinates of the vector \( \Bf \) contribute to this integral, and only those that lie in the tangent space.
The reciprocal basis vectors \( \Bx^i \) are also nowhere to be seen.  This is because they are either obliterated in dot products with \( \Bx_j \), or cancel due to mixed partial equality.

To see how this occurs let's look at the
area integrand of \cref{thm:surfaceintegral:500}
\begin{dmath}\label{eqn:surfaceintegral:660}
d^2 \Bx \cdot \lr{ \spacegrad \wedge \Bf }
=
du_1 du_2\, \lr{ \Bx_1 \wedge \Bx_2 } \cdot \lr{ \sum_{ij} \lr{ \Bx^i \partial_i } \wedge \lr{ f_j \Bx^j } }
=
du_1 du_2\, \sum_{ij} \lr{ \lr{ \Bx_1 \wedge \Bx_2 } \cdot \Bx^i } \cdot \lr{ \partial_i (f_j \Bx^j) }
=
du_1 du_2\, \sum_{ij} \lr{ \lr{ \Bx_1 \wedge \Bx_2 } \cdot \Bx^i } \cdot \Bx^j \partial_i f_j
+
du_1 du_2\, \sum_{ij} f_j \lr{ \lr{ \Bx_1 \wedge \Bx_2 } \cdot \Bx^i } \cdot (\partial_i \Bx^j).
\end{dmath}

With a bit of trouble, we will see that the second integrand is zero.  On the other hand, the first integrand
simplifies
without too much trouble
\begin{dmath}\label{eqn:surfaceintegral:680}
\sum_{ij} \lr{ \lr{ \Bx_1 \wedge \Bx_2 } \cdot \Bx^i } \cdot \Bx^j \partial_i f_j
=
\sum_{ij} \lr{ \Bx_1 \delta_{2i} - \Bx_2 \delta_{1i} } \cdot \Bx^j \partial_i f_j
=
\sum_{j} \Bx_1 \cdot \Bx^j \partial_2 f_j -\Bx_2 \cdot \Bx^j \partial_1 f_j
=
\partial_2 f_1 - \partial_1 f_2.
\end{dmath}

For the second integrand, we have
\begin{dmath}\label{eqn:surfaceintegral:700}
\begin{aligned}
\sum_{ij} &f_j \lr{ \lr{ \Bx_1 \wedge \Bx_2 } \cdot \Bx^i } \cdot (\partial_i \Bx^j) \\
&=
\sum_{j} f_j \sum_i \lr{ \Bx_1 \delta_{2i} - \Bx_2 \delta_{1i} } \cdot (\partial_i \Bx_j) \\
&=
\sum_{j} f_j
\lr{
\Bx_1 \cdot (\partial_2 \Bx^j)
-
\Bx_2 \cdot (\partial_1 \Bx^j)
}
\end{aligned}
\end{dmath}

We can apply the chain rule (backwards) to the portion in brackets to find
\begin{dmath}\label{eqn:surfaceintegral:720}
\Bx_1 \cdot (\partial_2 \Bx^j)
-
\Bx_2 \cdot (\partial_1 \Bx^j)
=
\cancel{\partial_2 \lr{ \Bx_1 \cdot \Bx^j }}
-
(\partial_2 \Bx_1) \cdot \Bx^j
-
\cancel{\partial_1 \lr{ \Bx_2 \cdot \Bx^j }}
+
(\partial_1 \Bx_2) \cdot \Bx^j
=
\Bx_j \cdot \lr{ \partial_1 \Bx_2 - \partial_2 \Bx_1 }
=
\Bx_j \cdot \lr{ \PD{u_1}{} \PD{u_2}{\Bx} - \PD{u_2}{} \PD{u_1}{\Bx} }
= 0.
\end{dmath}

In this reduction the derivatives of \( \Bx_i \cdot \Bx^j = \delta_{ij} \) were killed since those are constants (either zero or one).  The final step relies on the fact that we assume our vector parameterization is well behaved enough that the mixed partials are zero.

Substituting these results into
\cref{thm:surfaceintegral:500} we find
\begin{dmath}\label{eqn:surfaceintegral:740}
\ointclockwise_{\partial S} d\Bx \cdot \Bf
=
\ointclockwise_{\partial S} \lr{ du_1 \Bx_1 + du_2 \Bx_2 } \cdot \lr{ \sum_i f_i \Bx^i }
=
\ointclockwise_{\partial S} du_1\, f_1 + du_2\, f_2
=
\int_S du_1 du_2\, \lr{ \partial_2 f_1 - \partial_1 f_2 },
\end{dmath}
which completes the proof.

%}
%%%\EndArticle
